#!/usr/bin/env python
# -*- coding:utf-8 -*-

import tensorflow as tf

def reg_l2(p,p_hat):
    # tf.nn.l2_loss(a-b) = sum((a-b)**2) / 2
    p_hat=tf.reshape(p_hat,[-1,1]) #bug: before forget reshape ,result l2-loss is too big!!!
    loss=tf.nn.l2_loss(p-p_hat)
    return loss


a=tf.constant([4.8749433 , 4.386472  , 4.493562  , 0.7006434 , 2.7784224 , 2.9546063,
 2.6224775, 2.9522872, 4.3808365, 3.989337 , 2.7679737, 1.1444501,
 2.9678342, 4.7794495, 3.7535794, 1.0519825, 4.6329575, 4.7215815,
 2.3972476, 3.2327912, 0.9678153, 2.267538 , 3.1332028, 2.9427252,
 4.7079806, 3.0474956, 4.652559 , 3.386469 , 4.5859566, 2.2113569,
 1.9916533, 1.9603087, 4.7542386, 4.0839577, 2.0043864, 4.711887,
 2.0134158, 3.8024666, 3.3604884, 4.0990906, 4.5579324, 3.778232,
 4.4123216, 2.1232398, 3.5096598, 2.106301 , 4.866337 , 4.8100686])
b=tf.constant([[5.13889],[4.73529],[6.03226],[1.94737],[3.58333],[3.72973],[3.61905],[4.28571],
 [5.19048],[4.79412],[3.44444],[2.40541],[4.5    ],[5.84615],[4.25   ],[1.86667],[5.95556],[5.85294],
 [3.44118],[4.35714],[1.97368],[3.4186 ],[5.11628],[3.70588],[6.4    ],[3.65116],[4.64706],[4.96875],[6.11765],
 [3.86486], [3.27778],[3.17778], [5.87879],[5.05714],[3.40476],[3.37838],[3.25   ],[5.71429],[5.225  ],
 [5.     ],[5.57895],[5.325  ],[5.87097],[3.16667],[4.55556],[3.     ],[5.57895],[5.87805]])

if __name__=="__main__":
    with tf.Session() as sess:
        a=tf.reshape(a,[-1,1])
        l1=reg_l2(a,b)
        l1_out=sess.run(l1)
        print(l1_out)


